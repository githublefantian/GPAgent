<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>抓包脚本使用说明</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">.wmd-input, .wmd-input:focus, #md-section-helper {font-size: 15px !important;line-height: 25px !important;}
#wmd-preview {font-size: 15px !important;line-height: 25px !important;}

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="g07x" id="抓包脚本使用说明">抓包脚本使用说明</h1><p data-anchor-id="qgsx"><code>国拍</code></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="zfz7" id="工具介绍">工具介绍</h2><ol data-anchor-id="k5as">
<li><p>脚本工具：capture.sh</p></li>
<li><p>参数说明： <br>
命令行输入 <code>./capture.sh -h</code> 可查看简要介绍</p>

<pre><code>Usage:
 -d: duration_time(seconds)
 -s: start_time(timestamp or 12:00:30 format)
 -e: end_time(timestamp)
 -n: nic devices
 -o: output directory
 -h: show help information
</code></pre>

<p>具体参数说明如下(均为可选参数)： <br>
<code>-d</code>: 表示抓包持续时间，以秒为单位(支持且仅支持<code>*</code>运算)，如抓包2小时可表示为 <code>-d 7200</code> 或 <code>-d 2*3600</code> 或 <code>2*60*60</code> <br>
<code>-s</code>: 表示抓包开始时间，可以是时间戳(timestamp)，也可以是<code>HH:MM:SS</code>时间格式(默认日期为当天)，如9点开始抓包可表示为 <code>-d 09:00:00</code> <br>
<code>-e</code>: 表示抓包结束时间，只能是时间戳(timestamp)，建议结合使用 <code>-s</code> 和 <code>-d</code> 参数 <br>
<code>-n</code>: 表示需要抓包的网卡，多个网卡要以逗号隔开，如同时抓网卡p2p1和p2p2的包，则可表示为 <code>-n p2p1,p2p2</code> <br>
<code>-o</code>: 表示抓包文件的存放目录，生成的文件名格式为 <strong>"日期_开始时间_网卡名.pcap"</strong>, 如 <strong>"20161118_185000_p2p1.pcap"</strong> <br>
<code>-h</code>: 显示帮助信息</p></li>
<li><p><strong>默认设置</strong>：(上述所有参数均为可选参数) <br>
默认参数设置如下，若要修改请直接编辑 <code>capture.sh</code> 文件</p>

<ul><li>默认抓包网卡: <code>p2p1 p2p2 p2p3</code></li>
<li>默认抓包持续时间: <code>86400</code> 秒，即24小时（24*60*60）</li>
<li>默认抓包文件存放目录: <code>/backup/</code></li>
<li>默认日志目录: <code>/backup/log/</code> （存放日志文件的目录）</li>
<li>默认日志文件名: <code>capture.log</code> （可 <code>tail -f /backup/log/capture.log</code> 实时查看日志信息）</li>
<li>默认临时文件存放目录：<code>/backup/tmp/</code> （存放抓包结果信息）</li></ul></li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="z9zi" id="常用举例">常用举例</h2><ol data-anchor-id="2gn1">
<li><p>手动启动抓包</p>

<ul><li><code>./capture.sh</code> 在默认网卡上抓包 (退出按 <code>Ctrl+C</code>, 若不退出，则持续抓包24小时后自动退出)</li>
<li><code>./capture.sh -n p2p1</code> 仅在网卡p2p1上抓包 (退出按 <code>Ctrl+C</code>, 若不退出，则持续抓包24小时后自动退出)</li>
<li><code>./capture.sh -n p2p1 -d 3600</code> 抓包一小时后自动停止 (中途退出按 <code>Ctrl+C</code>)</li>
<li><code>./capture.sh -n p2p1 -d 3600 -o /home/</code> 抓包文件存放在/home/目录下</li></ul></li>
<li><p>定时启动抓包</p>

<ul><li><code>./capture.sh -s 09:00:00 -d 3*60*60</code> 定时上午9点启动抓包，且抓包3小时后自动停止</li>
<li><code>./capture.sh -s 09:00:00 -d 3*3600 -n p2p1</code> 上午9点到12点定时对网卡p2p1进行抓包</li>
<li><code>./capture.sh -s 09:00:00 -d 3*3600 -n p2p1 -o /home/</code></li></ul></li>
<li><p>抓包文件默认存放在<code>/backup/</code>目录下，<code>tail -f /backup/log/capture.log</code> 实时查看日志记录</p></li>
</ol></div>
</body>
</html>