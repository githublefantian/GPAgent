<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>使用说明</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="a3yh" id="使用说明">使用说明</h1><p data-anchor-id="r6fb"><code>使用说明</code></p><hr><p data-anchor-id="9pta"><div class="toc"><div class="toc">
<ul>
<li><a href="#使用说明">使用说明</a><ul>
<li><a href="#一环境说明">一、环境说明</a></li>
<li><a href="#二程序使用说明">二、程序使用说明</a></li>
<li><a href="#三其他说明">三、其他说明</a></li>
</ul>
</li>
</ul>
</div>
</div>
</p><div class="md-section-divider"></div><h2 data-anchor-id="kb49" id="一环境说明">一、环境说明</h2><ol data-anchor-id="jh43">
<li>CentOS7 </li>
<li>已安装tcpdump且libpcap版本号为1.1及以上（通过<code>tcpdumcp -h</code>可查询，如下）</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8dok"><ol class="linenums"><li class="L0"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="typ">Centos7</span><span class="pun">]#</span><span class="pln"> tcpdump </span><span class="pun">-</span><span class="pln">h</span></code></li><li class="L1"><code><span class="pln">tcpdump version </span><span class="lit">4.5</span><span class="pun">.</span><span class="lit">1</span></code></li><li class="L2"><code><span class="pln">libpcap version </span><span class="lit">1.5</span><span class="pun">.</span><span class="lit">3</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="wkmc" id="二程序使用说明">二、程序使用说明</h2><p data-anchor-id="qy8b"><strong>以 CentOS7_20160706.zip 为例</strong></p><ol data-anchor-id="osvy">
<li>解压文件，linux下运行<code>unzip -q CentOS7_20160706.zip</code></li>
<li><p>将要解析的pcapng文件全部上传或拷贝到解压后的CentOS7目录下（如下，上传了<em>1120end.pcapng</em>和<em>1121end.pcapng</em>文件）</p>

<ul><li>程序运行后若<strong>要保存原pcapng文件</strong>，请确保有足够的磁盘空间，如要解析60G的pcapng文件，最好上传完后还有30G的空闲磁盘空间，且后续第4步要运行<code>./run.sh</code></li>
<li>程序运行后若<strong>不需要保存原pcapng文件</strong>，则对磁盘空间要求不大 ，且后续第4步运行<code>./run_del.sh</code></li></ul>

<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="pun">/]#</span><span class="pln"> cd </span><span class="typ">Centos7</span><span class="pun">/</span></code></li><li class="L1"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="typ">Centos7</span><span class="pun">]#</span><span class="pln"> ls</span></code></li><li class="L2"><code><span class="lit">1120end</span><span class="pun">.</span><span class="pln">pcapng  </span><span class="lit">1121end</span><span class="pun">.</span><span class="pln">pcapng  dist  http_filter</span><span class="pun">.</span><span class="pln">sh  parse</span><span class="pun">.</span><span class="pln">sh  run</span><span class="pun">.</span><span class="pln">sh</span></code></li></ol></pre></li>
<li>命令行输入<code>chmod -R a+x .</code></li>
<li><p>若需要保存原pcapng包，命令行输入<code>./run.sh</code>开始执行程序，若不需要保存pcapng包，命令行输入<code>./run_del.sh</code>(如下,有足够的磁盘空间，以前者为例）</p>

<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="typ">Centos7</span><span class="pun">]#</span><span class="pln"> chmod </span><span class="pun">-</span><span class="pln">R a</span><span class="pun">+</span><span class="pln">x </span><span class="pun">.</span></code></li><li class="L1"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="typ">Centos7</span><span class="pun">]#</span><span class="pln"> </span><span class="pun">./</span><span class="pln">run</span><span class="pun">.</span><span class="pln">sh</span></code></li><li class="L2"><code><span class="pun">[</span><span class="pln">root@gf01 </span><span class="typ">Centos7</span><span class="pun">]#</span><span class="pln"> ls</span></code></li><li class="L3"><code><span class="lit">1120end</span><span class="pun">.</span><span class="pln">pcap  </span><span class="lit">1120end</span><span class="pun">.</span><span class="pln">pcapng  </span><span class="lit">1121end</span><span class="pun">.</span><span class="pln">pcap  </span><span class="lit">1121end</span><span class="pun">.</span><span class="pln">pcapng  dist  http</span><span class="pun">-</span><span class="pln">filter</span><span class="pun">.</span><span class="pln">log  http_filter</span><span class="pun">.</span><span class="pln">sh  parse</span><span class="pun">.</span><span class="pln">sh  result</span><span class="pun">.</span><span class="pln">csv  run</span><span class="pun">.</span><span class="pln">log  run</span><span class="pun">.</span><span class="pln">sh</span></code></li></ol></pre></li>
<li>程序运行成功后会生成<strong>result.csv</strong>文件，输出结果保存在该文件中 <br>
<ul><li>若有<strong>未响应</strong>的验证码http请求，则会打印出详细的<strong>请求IP（SOURCE_IP）</strong>， <strong>端口号(SOURCE_IP)</strong>，<strong>请求时间(TIME)</strong>和请求的精确时间（EPOCH_TIME）</li>
<li>最后显示的PACKET TOTALS、<strong>REQUEST TOTALS</strong>、<strong>RESPONSE TOTAL</strong>只是统计数据（作用不大），分别表示程序处理的HTTP数据包的总个数，<strong>验证码请求总数</strong>和<strong>有响应的验证码请求总数</strong>。</li></ul></li>
</ol><p data-anchor-id="4eaa">如下，没有<strong>SOURCE_IP</strong>等详细信息，即表示不存在未响应的验证码请求</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hhj7"><ol class="linenums"><li class="L0"><code><span class="pun">[</span><span class="pln">root@globus03 </span><span class="typ">CentOS7</span><span class="pun">]#</span><span class="pln"> cat result</span><span class="pun">.</span><span class="pln">csv </span></code></li><li class="L1"><code><span class="pln">SOURCE_IP</span><span class="pun">,</span><span class="pln">SOURCE_PORT</span><span class="pun">,</span><span class="pln">TIME</span><span class="pun">,</span><span class="pln">EPOCH_TIME</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">PACKET TOTALS</span><span class="pun">,</span><span class="lit">16</span></code></li><li class="L4"><code><span class="pln">REQUEST TOTALS</span><span class="pun">,</span><span class="lit">6</span></code></li><li class="L5"><code><span class="pln">RESPONSE TOTALS</span><span class="pun">,</span><span class="lit">6</span><span class="pln">   </span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="ytc0" id="三其他说明">三、其他说明</h2><ol data-anchor-id="zlon">
<li>若<code>./run.sh</code>或<code>./run_del.sh</code>运行结束后，没有生成result.csv文件，请查看目录下的<code>run.log</code>和<code>http-filter.log</code>日志</li>
<li>运行时间依操作系统配置而定，一般的解析20G文件需要18分钟</li>
</ol></div>
</body>
</html>