#!/usr/bin/env bash

PCAP_DIR="/home/pcap"
TMPPCAP_DIR="/home/tmppcap"
RESULT_DIR="/home/result"
AGENT_DIR="/root/agent/"
LOG_DIR="/root/home/log"

[ ! -d ${PCAP_DIR} ] && mkdir ${PCAP_DIR}
[ ! -d ${TMPPCAP_DIR} ] && mkdir ${TMPPCAP_DIR}
[ ! -d ${RESULT_DIR} ] && mkdir ${RESULT_DIR}
[ ! -d ${AGENT_DIR} ] && mkdir ${AGENT_DIR}
[ ! -d ${LOG_DIR} ] && mkdir ${LOG_DIR}



# 过滤数据包的参数
SPLITSIZE=5120              # 解析单个数据包的最大大小(切割)，基本单位是MB
SPLITSIZE_TCPDUMP=1999000   # tcpdump数据包切割时，单个数据包大小，约为1.8G(支持的最大值）
SPLITOVERLAP=1000           # 切割后的数据包合并时，合并的响应包个数
SPLIT_PARALLEL=6            # 并行处理数据包的最大并行度

## GET 示例: GET /bidimg/get.ashx?i=ffd5377fe6a050b...
## tcp[24:4]==0x2f626964 匹配 /bid; tcp[28:4]==696d67ef 匹配 img/ 字段
GET_FILTER="tcp[24:4]==0x2f626964 and dst port 80"
## tcp[20:2]==0x4854 匹配 HT， HTTP的前两位
RES_FILTER="tcp[20:2]==0x4854 and src port 80"
FILTER="(${GET_FILTER}) or (${RES_FILTER})"
